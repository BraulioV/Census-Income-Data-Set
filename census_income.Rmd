---
title: "Analizando el dataset Census Income"
author: "Marta Gómez y Braulio Vargas"
date: "3 de junio de 2016"
lang: es
output: 
  pdf_document:
    fig_caption: yes
    includes:
      in_header: structure.tex
    number_sections: yes
    toc: yes
    highlight: pygments
bibliography: bibliografia.bib
csl: ieee-with-url.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE,
	cache=TRUE
)
```

# Definición del problema a resolver y enfoque elegido

La base de datos escogida se denomina _Census Income_, aunque también es conocida como _Adult_. Se puede descargar [aquí](http://archive.ics.uci.edu/ml/datasets/Census+Income "aqui"). Esta base de datos tiene 48842 instancias, cada una con 14 atributos. El problema es que también tiene valores perdidos.

El problema consiste en predecir cuando una persona va a gastarse más de $50K basándonos en los datos del censo. Por tanto, estamos ante un problema de _clasificación_.

Los atributos de los que disponemos son:

* ___age___: atributo numérico que expresa la edad de la persona.

* ___workclass___: atributo categórico que expresa el tipo de empleo que tiene la persona. Los valores que puede tomar son:

    * _Private_: persona contratada en una empresa privada.
    
    * _Self-emp-not-inc_: autónomo.
    
    * _Self-emp-inc_: persona que tiene una empresa grande.
    
    * _Federal-gov_: funcionario del gobierno federal.
    
    * _Local-gov_: funcionario del gobierno local.
    
    * _State-gov_: funcionario del gobierto estatal.
    
    * _Without-pay_: persona en paro.
    
    * _Never-worked_: persona que nunca ha trabajado.
    
* ___fnlwgt (final weight)___: variable numérica que representa un peso, cada peso corresponde a una característica socio-económica de la población, por tanto, personas con características demográficas parecidas deben tener un peso parecido. [@fnlwgt]

* ___education___: variable categórica que representa el nivel de estudios de la persona. Los valores que puede tomar son: _Bachelors_, _Some-college_, _11th_, _HS-grad_, _Prof-school_, _Assoc-acdm_, _Assoc-voc_, _9th_, _7th-8th_, _12th_, _Masters_, _1st-4th_, _10th_, _Doctorate_, _5th-6th_, _Preschool_.

* ___education-num___: variable númerica que representa a la anterior.

* ___marital-status___: variable categórica que expresa el estado sentimental de la persona. Los valores que puede tomar son: 

    * _Married-civ-spouse_: la persona está casada con un civil.
    
    * _Divorced_: la persona está divorciada.
    
    * _Never-married_: la persona nunca ha estado casada.
    
    * _Separated_: la persona está separada.
    
    * _Widowed_: la persona es viuda.
    
    * _Married-spouse-absent_: la persona aparece como casada en el registro, pero no se encuentra a ninguna pareja [@maritalstatus].
    
    * _Married-AF-spouse_: la persona está casada con alguien de las fuerzas armadas.
    
* ___occupation___: variable categórica que describe el tipo de profesión que tiene la persona. Puede tomar los valores _Tech-support_, _Craft-repair_, _Other-service_, _Sales_, _Exec-managerial_, _Prof-specialty_, _Handlers-cleaners_, _Machine-op-inspct_, _Adm-clerical_, _Farming-fishing_, _Transport-moving_, _Priv-house-serv_, _Protective-serv_, _Armed-Forces_. 

* ___relationship___: variable que contiene el valor que puede tomar la relación de una persona con respecto a otra dentro de una familia. Contiene solo un valor por instancia del dato. Estos valores pueden ser _Wife_ (Esposa), _Own-child_ (hijo propio), _Husband_ (marido), _Not-in-family_ (sin familia), _Other-relative_ (otro tipo de familiar) y _Unmarried_ (soltero).

* ___race___: valor que describe la raza de la persona. Puede ser _White_ (Blanco), _Asian-Pac-Islander_ (asíatico o de las islas del pacífico), _Amer-Indian-Eskimo_ (indio americano o esquimal), _Other_ (otro) y _Black_ (negro).

* ___sex___: sexo de la persona, _Female_ (mujer) o _Male_ (hombre).

* ___capital-gain___: registro de la ganancia de capital de la persona.

* ___capital-loss___: registro de la pérdida de capital de la persona.

* ___hours-per-week___: corresponde a las horas de trabajo a la semana.

* ___country___: país de pertenencia. En este caso, hay una mayor variedad de valores, siendo los siguientes: _United-States_, _Cambodia_, _England_, _Puerto-Rico_, _Canada_, _Germany_, _Outlying-US(Guam-USVI-etc)_, _India_, _Japan_, _Greece_, _South_, _China_, _Cuba_, _Iran_, _Honduras_, _Philippines_, _Italy_, _Poland_, _Jamaica_, _Vietnam_, _Mexico_, _Portugal_, _Ireland_, _France_, _Dominican-Republic_, _Laos_, _Ecuador_, _Taiwan_, _Haiti_, _Columbia_, _Hungary_, _Guatemala_, _Nicaragua_, _Scotland_, _Thailand_, _Yugoslavia_, _El-Salvador_, _Trinadad&Tobago_, _Peru_, _Hong_, _Holand-Netherlands_,  o lo que es lo mismo, Estados-Unidos, Colombia, Inglaterra, Puerto-Rico, Canada, Alemania, Estados supervisados de los Estados Unidos, India, Japón, Grecia, Sudáfrica, China, Cuba, Irán, Honduras, Filipinas, Italia, Polonia, Jamaica, Vietnam, México, Portugal, Irlanda, Francia, República Dominicana, Laos, Ecuador, Taiwn, Haití, Colombia, Hungría, Guatemala, Nicaragua, Escocia, Tailandia, Yugoslavia, El Salvador y Trinidad-Tobago.

* ___income___: corresponde al valor que queremos predecir, puede tomar los valores "<=50K" o ">50K"

## Valores perdidos

Respecto a los valores perdidos, podríamos tomar tres enfoques diferentes: sustituirlos por una media, eliminar todas las filas que contengan algún valor perdido o no usar las variables que contengan valores perdidos. Para tomar esta decisión, primero hemos de estudiar el porcentaje de valores perdidos que presentan los datos.

Para ello, en primer lugar leemos los datos. 

```{r}
adult.train <- read.csv("./Data/adult.data", header=FALSE, col.names = c("age","workclass", 
        "fnlwgt","education","education-num","marital-status","occupation","relationship",
        "race","sex","capital-gain","capital-loss","hours-per-week","country","income"), 
        na.strings = c(" ?", "?"))
```

Una vez leídos, calculamos el número de variables perdidas en cada columna:

```{r}
apply(X=adult.train, MARGIN=2, FUN=function(columna) length(is.na(columna)[is.na(columna)==T]))
```

Sólo tienen valores perdidos los atributos _workclass_, _occupation_ y _country_.

También, vamos a comprobar el número de instancias que contienen algún dato perdido. Como ya hemos visto que los datos perdidos sólo se encuentran en las columnas *workclass*, *occupation* y *country*, nos fijaremos sólo en esas. Para ello, vamos a realizar lo siguiente:

```{r}
aux = is.na(adult.train)*1
rowsMissingValues = apply(X=aux, MARGIN=1,
         FUN = function(fila) sum(fila))
length(rowsMissingValues[rowsMissingValues > 0])
```

En total, sólo hay 2399 filas con valores perdidos. Al tener en total 32561 datos de entrenamiento, perder 2399 no supone una gran diferencia. Por tanto, lo más sencillo es eliminar las filas que contengan algún dato perdido.

```{r}
aux = rowsMissingValues * -1
aux[aux==0] = 1
i = 1:nrow(adult.train)
i=i*aux
adult.train.clean = data.frame(adult.train[i[i>0],])
```

# Codificación de los datos de entrada para hacerlos útiles a los algoritmos

# Valoración del interés de las variables para el problema y selección de un subconjunto

# Normalización de las variables

# Selección de las técnicas y valoración de la idoneidad de las mismas frente a otras alternativas

# Aplicación de la técnica

## Estimación de los parámetros

## Estimación de los hiperparámetros

## Error de generalización

# Idoneidad de la función de regularización usada

# Valoración de resultados

# Justificación de la solución obtenida en base a la ténica usada y los datos.

## Dimensión VC del modelo

## Error de generalización del modelo

## Curva de aprendizaje del modelo

# Referencias
